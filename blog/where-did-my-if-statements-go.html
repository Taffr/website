<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <link rel="stylesheet" href="/styles.css"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Where did my if-statements go?: Simon Tenggren.xyz</title>
  </head>
  <body>
    <div id="nav-elm"></div>
    <script type="module">
      import { Elm } from '../src/Elements/Nav.elm'
      Elm.Elements.Nav.init({ node: document.getElementById('nav-elm'), flags: "blog" })
    </script>
    <div class="page-wrapper">
      <div class="page-body-wrapper">
        <div class="blog-body">
          <div class="blog-title-stack">
            <h1 class="blog-title"> Where did my if-statements go? </h1>
            <div class="ui-separator-horizontal" style="width: 10%;"></div>
            <h2 class="blog-sub-title"> Safer and readable TypeScript</h2>
          </div>
          <div class="ui-separator-horizontal"></div>
            Take a look at the following bit of TypeScript code:
            <pre class="code-block">
<span class="token keyword">async function</span> <span class="token function">getData</span>(): <span class="token type">Data</span> {
  <span class="token keyword">const</span> response = <span class="token keyword">await</span> fetch(<span class="token string">'https://api.example.com/foo'</span>);
  <span class="token keyword">const</span> json = <span class="token keyword">await</span> response.<span class="token function">json</span>();

  <span class="token keyword">return</span> dataSchema.<span class="token function">parse</span>(json);
}
             </pre>
            Can you see what is wrong with it? 
            <br>
            <b><i> Any </i></b> of the lines can throw an exception, for multiple reasons.
            Depending on how granular one would like their errors, one would have to surround either each or all of the code in a try-catch to handle the potential exceptions that could (and probably will) occur.
            <br>
            <br>
            Interestingly, TypeScript offers no help here, even with the most strict of rules. As there is no concept of deferring errors to the caller with a <code>throws</code>-declaration
          </p>
          <h3 class="blog-sub-heading"> How do other languages deal with the problem? </h3>
          As I mentioned, some languages such as Java force you to declare that the methods throw an exception or catch it yourself. Go is a more interesting example, instead of throwing exceptions errors and results are returned in a tuple-like structure which when combined with a check for un-used variables semi-forces the caller to handle the error.
          <br>
          <br>
          The "problem" with this is that it requires a bunch of branches to created to check that the error is <code>nil</code>.
          Resulting in code that looks something like the following:
          <pre class="code-block">
result1, err := <span class="token function">doSomething</span>()
<span class="token keyword">if</span> err != <span class="token type">nil</span> {
    <span class="token keyword">return</span> <span class="token function">handleErr</span>(err) 
}

result2, err := <span class="token function">doAnotherThing</span>()
<span class="token keyword">if</span> err != <span class="token type">nil</span> {
    <span class="token keyword">return</span> <span class="token function">handleErr</span>(err) 
}

result3, err := <span class="token function">doYetAnotherThing</span>()
<span class="token keyword">if</span> err != <span class="token type">nil</span> {
    <span class="token keyword">return</span> <span class="token function">handleErr</span>(err) 
}
          </pre>
          This is a lot better than not checking the errors at all, and coming from JS/TS, I wish we had a similar a feature. Although the checking seems to me to be very repetitive to me. (I've heard that eventually you start to develop <code>if err</code>-blindness. Note: I am not a Go-developer)
  
        </div>
      </div>
    </div>
  </body>
